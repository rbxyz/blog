(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[698],{1134:(e,t,a)=>{Promise.resolve().then(a.bind(a,7929))},7929:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>p});var l=a(5155),s=a(2115),n=a(7711),i=a(7810),r=a(9173),d=a(4378),c=a(9988),o=a(7203),u=a(8173),m=a.n(u),x=a(5565);let h=(0,n.default)(()=>Promise.all([a.e(827),a.e(899)]).then(a.bind(a,4899)),{loadableGenerated:{webpack:()=>[null]},ssr:!1});function p(){let{isLoaded:e}=(0,r.d)(),{user:t}=(0,d.Jd)(),[a,n]=(0,s.useState)(null),[u,p]=(0,s.useState)({title:"",content:"",name:"Ruan | D3v"}),[b,j]=(0,s.useState)(null),{data:v,refetch:y}=i.i.post.all.useQuery(),f=i.i.post.create.useMutation({onSuccess:()=>y()}),g=i.i.post.update.useMutation({onSuccess:()=>y()}),w=i.i.post.delete.useMutation({onSuccess:()=>y()}),N=async e=>{var t;e.preventDefault();let l=null!==(t=u.imageUrl)&&void 0!==t?t:"";if(b){let e=new FormData;e.append("file",b);let t=await fetch("/api/upload",{method:"POST",body:e});l=(await t.json()).imageUrl}a?(await g.mutateAsync({id:a.id,...u,imageUrl:l}),n(null)):await f.mutateAsync({...u,imageUrl:l}),p({title:"",content:"",name:""}),j(null)},C=e=>{var t;n({id:e.id}),p({title:e.title,content:e.content,name:e.name,imageUrl:null!==(t=e.imageUrl)&&void 0!==t?t:""})},P=async e=>{confirm("Tem certeza que deseja excluir?")&&await w.mutateAsync(e)};return e?(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"mx-auto max-w-4xl p-6",children:[(0,l.jsx)("h1",{className:"mb-4 text-2xl font-bold",children:"Gerenciar Posts"}),(0,l.jsxs)("form",{onSubmit:N,className:"space-y-4",children:[(0,l.jsx)("input",{type:"text",name:"title",value:u.title,onChange:e=>{p(t=>({...t,[e.target.name]:e.target.value}))},placeholder:"T\xedtulo",className:"w-full rounded border p-2",required:!0}),(0,l.jsx)(h,{value:u.content,onChange:e=>{p(t=>({...t,content:null!=e?e:""}))},height:600,previewOptions:{remarkPlugins:[c.A,o.A]}}),(0,l.jsxs)("button",{type:"submit",className:"rounded bg-blue-500 px-4 py-2 text-white",children:[a?"Atualizar":"Criar"," Post"]})]})]}),(0,l.jsxs)("div",{className:"mt-6",children:[(0,l.jsx)("h2",{className:"mb-2 text-center text-xl font-semibold",children:"Posts Criados"}),null==v?void 0:v.map(e=>(0,l.jsxs)("div",{className:"mb-2 flex justify-between rounded border p-4",children:[(0,l.jsxs)("div",{children:[e.imageUrl&&(0,l.jsx)(x.default,{src:e.imageUrl,alt:e.title,width:300,height:200,className:"mb-4 rounded-lg object-cover",priority:!0}),(0,l.jsx)("h3",{className:"text-lg font-bold",children:e.title}),(0,l.jsxs)("p",{className:"text-sm text-gray-600",children:["Por ",e.name]}),(0,l.jsx)(m(),{href:"/post/".concat(e.slug),className:"text-blue-600",children:"Ver Post"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("button",{onClick:()=>C(e),className:"mr-2 text-yellow-500",children:"Editar"}),(0,l.jsx)("button",{onClick:()=>P(e.id),className:"text-red-500",children:"Excluir"})]})]},e.id))]})]}):(0,l.jsx)("p",{className:"text-center text-gray-500",children:"Carregando..."})}},7810:(e,t,a)=>{"use strict";let l;a.d(t,{TRPCReactProvider:()=>b,i:()=>p});var s=a(5155),n=a(5906),i=a(5977),r=a(6276),d=a(7829),c=a(2115),o=a(3806),u=a(5604),m=a(9876);let x=()=>new u.E({defaultOptions:{queries:{staleTime:3e4},dehydrate:{serializeData:o.Ay.serialize,shouldDehydrateQuery:e=>(0,m.XS)(e)||"pending"===e.state.status},hydrate:{deserializeData:o.Ay.deserialize}}});a(2818);let h=()=>null!=l?l:l=x(),p=(0,d.pY)();function b(e){let t=h(),[a]=(0,c.useState)(()=>p.createClient({links:[(0,r.$)({enabled:e=>"down"===e.direction&&e.result instanceof Error}),(0,i.kM)({transformer:o.Ay,url:window.location.origin+"/api/trpc",headers:()=>{let e=new Headers;return e.set("x-trpc-source","nextjs-react"),e}})]}));return(0,s.jsx)(n.Ht,{client:t,children:(0,s.jsx)(p.Provider,{client:a,queryClient:t,children:e.children})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[212,701,611,970,742,441,517,358],()=>t(1134)),_N_E=e.O()}]);